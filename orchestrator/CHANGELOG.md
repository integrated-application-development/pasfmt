# Changelog

This file documents notable changes to the `pasfmt-orchestrator` crate.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

## [0.4.0-rc2] - 2025-03-12

## [0.4.0-rc1] - 2025-02-20

### Fixed

- `--config-file` no longer erroneously accepts a path to a directory and searches from it for a
  `pasfmt.toml` file. It is now an error to provide a path to a directory.
- Fixed detection of decoding errors when reading from stdin.
- Stopped ignoring non-existent paths (they were being treated as globs matching no files).
- Fixed errors when writing non-ASCII data in an ANSI encoding to a Windows Console. Now written as Unicode.

### Added

- Added debug logging for time taken to format each file.
- Added `try_create` and `validate` functions to the type generated by the `pasfmt_config!` macro.
- Added cursor tracking, via the `--cursor` CLI option.
  - `FormatterConfiguration::cursors` method provides the interface

### Removed

- Removed `Default` trait impl for `PasFmtConfiguration`.
- Added ability to override configuration on the CLI with escaped values eg (`-Ckey="\uFF"`).
- Removed use of `Default::default` in `PasFmtConfiguration::get_config_object` to initialise the
  configuration object defaults. Users can instead provide the defaults in the `Deserialize` impl.
- Removed logging of the (toml-serialised) configuration object in `PasFmtConfiguration::get_config_object`.
  Users can log the object however they want outside of this function.

## [0.3.0] - 2024-05-29

### Fixed

- Fixed erroneous removal of BOM.
- Fixed erroneous transcoding of UTF-16 input to UTF-8.
- Fixed unwanted use of the replacement character when encoding. This now results in an error.

### Changed

- Renamed `--files-file` parameter to `--files-from`.

## [0.2.0] - 2024-05-07

### Fixed

- Removed extra trailing newline when formatting stdin to stdout.
- Fixed incorrect encoding used for writing files with encodings inferred from a BOM.
- Fixed incorrect encoding used in stdin/stdout mode; UTF-8 was always used, but now the configured
  encoding is respected.

### Changed

- Changed the default encodings
  - Windows: system ANSI codepage.
  - non-Windows: UTF-8.
- Improved handling of IO errors.

### Added

- Added `-C` CLI option to override configuration options.
- Added `--mode` CLI option which replaces the `--write` and `--verify` options.

### Removed

- Removed short version of `--config-file` CLI option.
- Removed `--write`/`-w` CLI option (now accessible via `--mode=files`).
- Removed `--verify` CLI option (replaced by `--mode=check` with some differences).

## [0.1.0] - 2023-08-28

### Added

- Added orchestrator to handle parallelising the reading, formatting, and writing of files.
- Added configuration and command-line frameworks.
- Added default command-line interface.
